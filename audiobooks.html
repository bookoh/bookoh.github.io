<!-- audiobooks.html (뮤직 페이지도 이 패턴 그대로 쓰면 됨) -->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>BSBKTV Audiobooks</title>

    <!-- 1) Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- 2) 공통 클라이언트 -->
    <script src="supabase-client.js"></script>

    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        margin: 0;
        padding: 16px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>오디오북</h1>
    </header>

    <section id="audiobook-list"></section>

    <script>
      async function loadAudiobooks() {
        const listEl = document.getElementById('audiobook-list');

        const { data, error } = await db
          .from('audiobooks')
          .select('*')
          .order('created_at', { ascending: false });

        if (error) {
          console.error(error);
          listEl.textContent = '오디오북 불러오기 실패';
          return;
        }

        if (!data || data.length === 0) {
          listEl.textContent = '등록된 오디오북이 없습니다.';
          return;
        }

        listEl.innerHTML = data
          .map((item) => {
            return `
              <article>
                <h2>${item.title}</h2>
                <p>${item.description || ''}</p>
              </article>
            `;
          })
          .join('');
      }

      loadAudiobooks();
    </script>
  </body>
</html>
