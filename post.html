<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>게시글</title>
</head>
<body>
  <a href="javascript:history.back()">← 목록으로</a>

  <article id="post"></article>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="supabase-client.js"></script>
  <script>
    const params = new URLSearchParams(location.search);
    const postId = parseInt(params.get('id') || '0', 10);

    if (!postId) {
      document.getElementById('post').innerText = '잘못된 글입니다.';
    } else {
      loadPost();
    }

    async function loadPost() {
      const box = document.getElementById('post');
      box.innerText = '글 불러오는 중...';

      const { data, error } = await supa
        .from('posts')
        .select('*')
        .eq('id', postId)
        .single();

      if (error || !data) {
        box.innerText = '글을 불러오지 못했습니다.';
        return;
      }

      box.innerHTML = `
        <h1>${data.title}</h1>
        <div>
          ${data.nickname || '익명'} / ${new Date(data.created_at).toLocaleString()} / ♥ ${data.likes_count}
        </div>
        <pre>${data.content}</pre>
      `;
    }
  </script>
</body>
</html>
