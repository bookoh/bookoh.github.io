<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>게시글 보기</title>
</head>
<body>
  <div id="post">로딩 중...</div>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    const box = document.getElementById('post');

    const params = new URLSearchParams(location.search);
    const postIdRaw = params.get('id');
    const postId = parseInt(postIdRaw || '0', 10);

    // 0. id 확인
    box.textContent = '[STEP0] raw=' + postIdRaw + ', parsed=' + postId;

    // 1. 여기 두 줄을 너 프로젝트 값으로 교체
    const supa = window.supabase.createClient(
      'https://dmjaxhydwaumhujrculd.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRtamF4aHlkd2F1bWh1anJjdWxkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MTEyNTgsImV4cCI6MjA4MDI4NzI1OH0.nTdfW9Iw3OLyYbWcPGU2T8P_i-9tDeqUn1t2cAsIbn0'
    ); // 대시보드의 Project URL, anon public key 사용[web:413][web:409]

    if (!postId) {
      box.textContent += ' / 잘못된 글입니다.';
    } else {
      loadPost();
    }

    async function loadPost() {
      box.textContent = '[STEP1] loading postId=' + postId;

      const { data, error } = await supa
        .from('posts')
        .select('*')
        .eq('id', postId)
        .maybeSingle(); // 0개나 1개일 때 쓰는 메서드[web:394][web:405]

      // 2. Supabase 응답을 그대로 출력
      box.textContent =
        '[STEP2]
' +
        'error=' + JSON.stringify(error) + '
' +
        'data=' + JSON.stringify(data);
    }
  </script>
</body>
</html>
