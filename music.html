<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>뮤직</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-client.js"></script>
</head>
<body>
  <header>
    <h1>뮤직</h1>
  </header>

  <section id="music-list">
    뮤직 불러오기 실패
  </section>

  <script>
    // supabase-client.js: const db = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function loadMusic() {
      const listEl = document.getElementById('music-list');

      const { data, error } = await db
        .from('music_tracks')                // 테이블 이름: music_tracks
        .select('*')
        .order('created_at', { ascending: false });

      if (error) {
        console.error(error);
        listEl.textContent = '뮤직 불러오기 실패';
        return;
      }

      if (!data || data.length === 0) {
        listEl.textContent = '등록된 뮤직이 없습니다.';
        return;
      }

      listEl.innerHTML = '';

      data.forEach((track) => {
        const div = document.createElement('div');
        div.className = 'music-item';

        div.innerHTML = `
          <h2>${track.title ?? ''}</h2>
          <p>${track.artist ?? ''}</p>
          <p>${track.genre ?? ''}</p>
          ${track.audio_url ? `<audio controls src="${track.audio_url}"></audio>` : ''}
          <p>${track.description ?? ''}</p>
        `;

        listEl.appendChild(div);
      });
    }

    loadMusic();
  </script>
</body>
</html>
